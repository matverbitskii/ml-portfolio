# Портфолио специалист по Data Science

## [1] Прогнозирование оттока клиентов телеком компании
**Цель:** Разработать решение, которое позволит на основании собранных командой данных предсказывать, разорвет ли клиент договор.

**Стек:** pandas, matplotlib, seaborn, scikit-learn,, numpy, shap, phik, CatBoost

**Результат:** Разработана модель на базе CatBoostClassifier. ROC-AUC на тестовой выборке после отбора признаков 0.92, Accuracy (точность) 0.9.

1. Рекомендуем к использованию модель final_model в исходном виде для прогнозирования оттока клиентов (ее точность 0.9);
2. Рекомендуем переводить действующих клиентов на помесячную оплату с получением счета на почту, это позволит снизить риски отвала, основываясь на анализе важности признаков лучшей модели. Чтобы клиенты более охотно переходили на такой формат оплаты, рекомендуем разослать всем клиентам, которые оплачивают ежегодно или раз в 2 года письмо и уведомление о том, что в рамках новой акции можно будет получить скидку на обслуживание, если получать счет на почту и перевести оплату на помесячную.
3. Так как клиенты с большей длительностью договора и меньшей суммой расходов (всего и месячных) менее склонны к отвалу, рекомендуем всем действующим клиентам со склонностью к отвалу на основании предсказаний модели отправить промокод на скидку, чтобы снизить сумму их расходов и/или подарить месяц бесплатного обслуживания для тех же целей.
4. Так как использующие сервис с параллельными линиями более склонны к отвалу, рекомендуем проверить, довольны ли эти клиенты качеством услуг, предоставляемых в рамках этого сервиса, так как это может быть причиной повышенной склонности к отвалу. Если гипотеза подтвердится, то рекомендуем пересмотреть подходы и повысить качество услуг, чтобы этот признак не оказывал дополнительного отрицательного влияния на отвал.


## [2] Определение склонных к увольнению сотрудников
**Цель:** Разработать решение, которое позволит бизнесу избежать финансовых потерь и оттока сотрудников.

**Стек:** pandas, matplotlib, seaborn, scikit-learn,, numpy, shap, phik

**Результат:** 
- Разработана модель для прогнозирования уровня удовлетворенности работой у сотрудников на основании входных признаков: Показатель SMAPE на тестовой выборке 13.9.
- Разработана модель, способная прогнозировать увольнение сотрудника, ROC-AUC на тестовой выборке 0.92.
- Компании выгодно, чтобы сотрудники уровня junior доросли до middle, а middle - до senior как можно скорее, так как этот показатель значительно влияет на увольнение. Чтобы этого достичь, предлагаем в каждом подразделении разработать индивидуальные планы развития для каждого сотрудника уровня junior и middle, обозначить цели на будущие периоды и четкие критерии перехода на новый уровень. Компании также выгодно, чтобы сотрудники больше зарабатывали, предложенная в данной рекомендации мера повысит и этот показатель, так как с ростом уровня растет и зарплата.
- Компании выгодно, чтобы сотрудники работали в компании дольше 2-3 лет, это снижает вероятность увольнения - как меру стимулирования предлагаем сотрудникам, которые проработали в компании 2 года (и работают третий) повышение зарплаты в виде ежемесячной премии за стаж после того, как будет 3 года с момента трудоустройства. То же самое можно предложить тем, кто проработал 3 года - ежемесячную премию после 4-го года работы. Это позволит стимулировать сотрудников не увольняться, так как работающие в компании 3 года увольняются значительно реже, чем те, кто проработал меньше, а кто работает 4 года и больше - увольняются крайне редко.
- Компании выгодно, чтобы сотрудники были сбалансированно загружены - предлагаем поручить руководителям подразделений контролировать, чтобы у их сотрудников стало меньше перегрузки во время рабочего дня и переработок, а а тем, кто недонагружен, необходимо определить и дать дополнительные задачи. Данная мера позволит приблизить уровень загруженности сотрудников к сбалансированному состоянию и снизит вероятность увольнения.
- На увольнение сильно влияет показатель уровень удовлетворенности работой, на который, в свою очередь, значительно влияет оценка руководителем. Чтобы повысить оба эти показателя, предлагаем поручить руководителям отделов разработать систему оценивания с критериями и метриками, а сотрудников с оценками 4 и 5 поквартально премировать. Сотрудники будут знать, что конкретно они должны делать, чтобы повысить оценку, а компания не потратит на премии большое количество денег. Как следствие, сотрудники начнут сами влиять на свои оценки, показатель удовлетворенности работой вырастет, и снизится вероятность увольнения.



## [3] Оценка влияния маркетинговых инструментов на спрос на автомобили
**Цель:** Определить факторы, влияющие на количество звонков в дилерские центры, в том числе оценить эффективность проводимых маркетинговых кампаний. Задача включает анализ временных рядов.

**Стек:** pandas, matplotlib, seaborn, scikit-learn, numpy, shap, phik, LightGBM, statsmodels

**Результат:** 
- Получена модель LGBMRegressor(bagging_fraction=0.8, bagging_freq=1, lambda_l2=5, max_depth=2, min_split_gain=2,num_leaves=2)), ее показатель МАЕ на кросс-валидации 6.4. МАЕ на валидационной выборке 16.7, на 23% лучше предсказания средним тренировочной выборки, но хуже предсказания значением вчерашнего дня;
- Получены статистические выводы о том, что распределение целевого признака в тренировочной и валидационной выборке отличаются, выводы подкрепляются анализом боксплотов и сравнением графиков истинного значения таргета и предсказанного моделью;
- Чтобы улучшить качество модели, необходимо больше данных за 2015 год, возможно тренды конца 2014 продолжатся, и можно будет построить и обучить более сильную модель; Также на улучшение качества модели для анализа спроса могут повлиять дополнительные признаки, например, количество писем на почту, активность менеджеров по продажам и анализ других маркетинговых инструментов. Ведь компания могла нанять в конце 2014 целый колл-центр для привлечения, и количество звонков увеличилось в связи с увеличением количества исходящих звонков.
- Анализ признаков:
    - Самый сильный признак - день недели. В выходные звонков значительно меньше, чем в будни;
    - Лаги и скользящее среднее сильно влияют на количество звонков.

**Рекомендации для заказчика**
- Рекомендуем заказчику собрать данные хотя бы за первое полугодие 2015, и заново обучить модель, так как результаты анализа заключают о смене тренда в конце 2014.
- Модель можно применять для предсказания количества звонков, если всплеск осенью-зимой 2014 окажется выбросом или аномалиями, то есть если по результату первого квартала 2015 тренд будет аналогичный, как в 2014 и в 2013.
- Показы по телевидению повышают количество звонков. Для повышения количества звоноков рекомендуем продвижение через телевидение.


## [4] Удержание клиентов
**Цель:** Разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность

**Стек:** pandas, matplotlib, scipy, seaborn, sklearn, numpy, shap, phik

**Результат:** 
- Чтобы у давних клиентов сайта сохранялась покупательская способность, рекомендуем чаще направлять им предложения (увеличить среднюю маркетинговую активность). Также необходимо увеличить время, проводимое на сайте, можно это сделать, если рекомендации и предложения будут обязательно включать любимую категорию пользователя, но не только ее (небольшое разнообразие в предложенных категориях повышает вероятность присваивания класса 0).
- Необходимо снизить количество неоплаченных товаров в корзине у пользователей - можно разослать персональные предложения со скидкой на продукцию из их корзины клиентам, у которых долгое время в корзине лежит не оплаченный товар. Это позволит их смотивировать купить быстрее и, как следствие, не потерять активность
- Необходимо проверить, какие промо-акции проводились в препредыдущем месяце и сопоставить результаты с результатами работы модели - может выясниться, что спланированная (например, кампания для быстрого сбыта неходового товара точно испортила бы статистику) маркетинговая кампания принесла много покупок акционного товара, что сейчас портит статистику. Если подобных кампаний не проводилось, можно попробовать разослать клиентам с высокой выручкой в препредыдущем месяце персональные предложения, которые будут обязательно включать любимую категорию пользователя, но не только ее.


## [5] Оптимизация процесса выбора региона для разработки нефтяных месторождений
**Цель:** Определить наиболее выгодный и менее рискованный регион для разработки нефтяных месторождений

**Стек:** pandas, matplotlib, seaborn, sklearn, numpy, shap, phik

**Результат:** 
- С помощью процедуры Bootstrap составлены распределения прибыли от разработки каждого из регионов (при выборе 200 лучших точек по предсказанию наших моделей МО из 500 исследуемых), получены 95%-е доверительные интервалы прибыли, а также средние значения и значения риска убытков по каждому из регионов.
- Для заказчика сформирована рекомендация по выбору региона: Разработку необходимо начинать в Регионе 1, так как он является лучшим по всем показателям: Доверительный интервал прибыли - от 35.73 до 828.01 млн. Риск убытков всего 1.6%, отрицательные значения не попали в доверительный интервал модели. Средняя прибыль 441.5 млн.


## [6] Разработка решения для определение рыночной цены автомобиля с пробегом
**Цель:** Разработать модель машинного обучения, которая позволит на основании характеристик автомобиля прогнозировать рыночную стоимость автомобиля.

**Стек:** pandas, matplotlib, seaborn, sklearn, numpy, shap, phik, LightGBM

**Результат:** Разработаны две модели определения цены: быстрая и точная:
- Дерево решений. RMSE на кросс-валидации 2302, Время обучения 221 милисекунда, предсказания 12.1 милисекунд.
- LightGBM. RMSE на кросс-валидации 1813. Время обучения 364 милисекунды, предсказания 81.2 милисекунды.
- Модель на основе LightGBM точнее на 21%, но обучается примерно на 50% дольше, пронгозирует значительно дольше. Рекомендуем использовать именно ее.
  
## [7] Прогнозирование количества заказов такси. Анализ временных рядов.
**Цель:** Разработать модель, которая сможет спрогнозировать количество заказов такси на следующий час.

**Стек:** pandas, matplotlib, seaborn, sklearn, numpy, LightGBM, CatBoost

**Результат:** 
- Разработана модель LightGBM для предсказания количества заказов такси, RMSE на тестовой выборке 37.5, (RMSE при предсказании средним по тренировочной выборке: 84.5).
- Исследовано влияние признаков на результат прогнозирования количества заказов такси. Сильнее всего на количество заказов такси влияет количество заказов в тот же день неделю назад, также значительно влияет час.
